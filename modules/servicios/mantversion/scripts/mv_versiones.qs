////////////////////////////////////////////////////////////////////////////
//// DECLARACION ///////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////
//// INTERNA /////////////////////////////////////////////////////
class interna {
    var ctx:Object;
    function interna( context ) { this.ctx = context; }
    function init() { this.ctx.interna_init(); }
}
//// INTERNA /////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////
//// OFICIAL /////////////////////////////////////////////////////
class oficial extends interna {
    function oficial( context ) { interna( context ); } 
}
//// OFICIAL /////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////
//// DESARROLLO /////////////////////////////////////////////////
class head extends oficial {
		var util:FLUtil;
		
    function head( context ) { oficial ( context ); }
		function init() {
				return this.ctx.head_init();
		}
		function tbnBuscarVersion_clicked() {
				return this.ctx.head_tbnBuscarVersion_clicked();
		}
}
//// DESARROLLO /////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////
//// INTERFACE  /////////////////////////////////////////////////
class ifaceCtx extends head {
    function ifaceCtx( context ) { head( context ); }
}

const iface = new ifaceCtx( this );
//// INTERFACE  /////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////
//// DEFINICION ////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////
//// INTERNA /////////////////////////////////////////////////////

function init() {
    this.iface.init();
}

function interna_init() {

}
//// INTERNA /////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////
//// OFICIAL /////////////////////////////////////////////////////

//// OFICIAL /////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////
//// DESARROLLO /////////////////////////////////////////////////
function head_init() 
{
		this.iface.util = new FLUtil; 
		
		connect(this.child("tbnBuscarVersion"), "clicked()", this, "iface.tbnBuscarVersion_clicked()");
		
		if (this.cursor().modeAccess() != this.cursor().Insert)
				;//this.child("tbnBuscarVersion").enabled = false;
}

/** \D
Muestra el listado de versiones para elegir cuál es la versión padre de la actual
\end */
function head_tbnBuscarVersion_clicked()
{
		var f:Object = new FLFormSearchDB("mv_versiones");
		f.setMainWidget();
		f.cursor().setMainFilter("idarea = '" + this.cursor().valueBuffer("idarea") + "'" + 
				" AND idmodulo = '" + this.cursor().valueBuffer("idmodulo") + "'" +
				" AND codversion <> '" + this.cursor().valueBuffer("codversion") + "'");
		var idVersion:String = f.exec("idversion");
		if (idVersion) {
				this.cursor().setValueBuffer("idversionpadre", idVersion);
		}
}

//// DESARROLLO /////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////
//// INTERFACE  /////////////////////////////////////////////////

//// INTERFACE  /////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////